<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>rent-a-car documentation</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="icon" type="image/x-icon" href="../images/favicon.ico">
	      <link rel="stylesheet" href="../styles/style.css">
        <link rel="stylesheet" href="../styles/Stripe.css">
    </head>
    <body>

        <div class="navbar navbar-default navbar-fixed-top visible-xs">
            <a href="../" class="navbar-brand">rent-a-car documentation</a>
            <button type="button" class="btn btn-default btn-menu ion-ios-menu" id="btn-menu"></button>
        </div>

        <div class="xs-menu menu" id="mobile-menu">
                <div id="book-search-input" role="search"><input type="text" placeholder="Type to search"></div>            <compodoc-menu></compodoc-menu>
        </div>

        <div class="container-fluid main">
           <div class="row main">
               <div class="hidden-xs menu">
                   <compodoc-menu mode="normal"></compodoc-menu>
               </div>
               <!-- START CONTENT -->
               <div class="content injectable">
                   <div class="content-data">







<ol class="breadcrumb">
  <li>Injectables</li>
  <li>GivenNoticePipe</li>
</ol>

<ul class="nav nav-tabs" role="tablist">
        <li class="active">
            <a href="#info" role="tab" id="info-tab" data-toggle="tab" data-link="info">Info</a>
        </li>
        <li >
            <a href="#source" role="tab" id="source-tab" data-toggle="tab" data-link="source">Source</a>
        </li>
</ul>

<div class="tab-content">
    <div class="tab-pane fade active in" id="c-info">
        <p class="comment">
            <h3>File</h3>
        </p>
        <p class="comment">
            <code>src/rental/pipes/given-notice.pipe.ts</code>
        </p>

            <p class="comment">
                <h3>Description</h3>
            </p>
            <p class="comment">
                <p>summary: creates a <a href="https://moment.github.io/luxon/"><strong>Luxon</strong></a> <a href="https://moment.github.io/luxon/docs/manual/tour.html#intervals"><strong>Interval</strong></a> from the startTime and currentTime
and then uses Luxon methods to validate the Given Notice is at least 1 hour in duration; this is the minimum allowed for any user</p>
<ul>
<li>Luxon is &quot;a powerful, modern, and friendly wrapper for Javacript dates and times&quot;</li>
</ul>

            </p>



            <section>
    <h3 id="index">Index</h3>
    <table class="table table-sm table-bordered index-table">
        <tbody>

                <tr>
                    <td class="col-md-4">
                        <h6><b>Methods</b></h6>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <ul class="index-list">
                            <li>
                                    <span class="modifier">Private</span>
                                    <span class="modifier">Async</span>
                                <a href="#createGivenNotice">createGivenNotice</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#transform">transform</a>
                            </li>
                            <li>
                                    <span class="modifier">Private</span>
                                    <span class="modifier">Async</span>
                                <a href="#validateRequestedTime">validateRequestedTime</a>
                            </li>
                        </ul>
                    </td>
                </tr>





        </tbody>
    </table>
</section>


            <section>
    
    <h3 id="methods">
        Methods
    </h3>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="createGivenNotice"></a>
                    <span class="name">
                        <b>
                            <span class="modifier">Private</span>
                            <span class="modifier">Async</span>
                            createGivenNotice
                        </b>
                        <a href="#createGivenNotice"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>createGivenNotice(startTime)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="20"
                            class="link-to-prism">src/rental/pipes/given-notice.pipe.ts:20</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>summary: create the <strong>givenNotice</strong> property value, it must be at least one hour</p>
</div>

                    <div class="io-description">
                        <b>Parameters :</b>
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Optional</td>
                                    <td>Description</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>startTime</td>

                                    <td>
                                        No
                                    </td>


                                    <td>
                                        <p>the request start time of the rental</p>

                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>    <code>{}</code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="transform"></a>
                    <span class="name">
                        <b>
                            <span class="modifier">Async</span>
                            transform
                        </b>
                        <a href="#transform"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>transform(value: <a href="../classes/RawSearchRentalDto.html">RawSearchRentalDto</a>)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="51"
                            class="link-to-prism">src/rental/pipes/given-notice.pipe.ts:51</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>summary: use the validateRequestedTime and createGivenNotice methods to return a GivenNoticeSearchRentalDto</p>
</div>

                    <div class="io-description">
                        <b>Parameters :</b>
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                    <td>Description</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>value</td>
                                    <td>
                                                <code><a href="../classes/RawSearchRentalDto.html" target="_self" >RawSearchRentalDto</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                    <td>
                                        <p>the raw client request data to search for rentals</p>

                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>    <code>Promise&lt;GivenNoticeSearchRentalDto&gt;</code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="validateRequestedTime"></a>
                    <span class="name">
                        <b>
                            <span class="modifier">Private</span>
                            <span class="modifier">Async</span>
                            validateRequestedTime
                        </b>
                        <a href="#validateRequestedTime"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>validateRequestedTime(startTime, endTime)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="36"
                            class="link-to-prism">src/rental/pipes/given-notice.pipe.ts:36</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>summary: validate that the rental start time is not before the requested rental end time. The frontend of course has validation for this on the form,
this is just another level of validation.</p>
</div>

                    <div class="io-description">
                        <b>Parameters :</b>
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Optional</td>
                                    <td>Description</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>startTime</td>

                                    <td>
                                        No
                                    </td>


                                    <td>
                                        <p>the requested time for the Rental to begin</p>

                                    </td>
                                </tr>
                                <tr>
                                    <td>endTime</td>

                                    <td>
                                        No
                                    </td>


                                    <td>
                                        <p>the requested time for the Rental to end</p>

                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</section>

    </div>


    <div class="tab-pane fade  tab-source-code" id="c-source">
        <pre class="line-numbers compodoc-sourcecode"><code class="language-typescript">import {
  Injectable,
  PipeTransform,
} from &#x27;@nestjs/common&#x27;;
import { GivenNoticeSearchRentalDto } from &#x27;../dto/searchRental/given-notice-search-rental-dto&#x27;;
import { RawSearchRentalDto } from &#x27;../dto/searchRental/raw-search-rental.dto&#x27;;
import { DateTime } from &#x27;luxon&#x27;;
/**
 * summary: creates a [**Luxon**](https://moment.github.io/luxon/) [**Interval**](https://moment.github.io/luxon/docs/manual/tour.html#intervals) from the startTime and currentTime
 * and then uses Luxon methods to validate the Given Notice is at least 1 hour in duration; this is the minimum allowed for any user
 * - Luxon is &quot;a powerful, modern, and friendly wrapper for Javacript dates and times&quot;
 */
@Injectable()
export class GivenNoticePipe implements PipeTransform {

  /**
   * summary: create the **givenNotice** property value, it must be at least one hour
   * @param startTime the request start time of the rental
   */
  private async createGivenNotice(startTime) {
    const givenNotice: number &#x3D; startTime.diffNow().toObject().milliseconds;
    if (givenNotice &gt;&#x3D; 3600000) {
      return givenNotice;
    }
    throw new Error(
      &#x27;Sorry, you cannot request a rental less than an hour before it begins&#x27;,
    );
  }

  /**
   * summary: validate that the rental start time is not before the requested rental end time. The frontend of course has validation for this on the form,
   * this is just another level of validation.
   * @param startTime the requested time for the Rental to begin
   * @param endTime the requested time for the Rental to end
   */
  private async validateRequestedTime(startTime, endTime) {
    if (startTime &gt; endTime) {
      throw new Error(
        &#x27;The rental start time cannot be after the rental end time&#x27;,
      );
    }
    if (endTime.diff(startTime).toObject().milliseconds &lt; 3600000) {
      throw new Error(&#x27;The rental must be at least 1 hour in Duration&#x27;);
    }
  }

  /**
   * summary: use the validateRequestedTime and createGivenNotice methods to return a GivenNoticeSearchRentalDto
   * @param value the raw client request data to search for rentals
   */
  async transform(value: RawSearchRentalDto):Promise&lt;GivenNoticeSearchRentalDto&gt; {
    try {
      // make start and end time into DateTimes
      const startTime: DateTime &#x3D; DateTime.fromISO(
        new Date(value.rentalStartTime).toISOString(),
      );
      const endTime: DateTime &#x3D; DateTime.fromISO(
        new Date(value.rentalEndTime).toISOString(),
      );
      await this.validateRequestedTime(startTime, endTime);
      const givenNotice &#x3D; await this.createGivenNotice(startTime);
      const dto: GivenNoticeSearchRentalDto &#x3D; {
        address: value.address,
        rentalStartTime: startTime,
        rentalEndTime: endTime,
        price: value.price ? value.price : null,
        features: value.features ? value.features : null,
        givenNotice,
      };
      return dto;
    } catch (err) {
      throw new Error(err);
    }
  }
}
</code></pre>
    </div>

</div>







                   




                   </div><div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> result-matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div>
</div>
               <!-- END CONTENT -->
           </div>
       </div>

       <script>
            var COMPODOC_CURRENT_PAGE_DEPTH = 1;
            var COMPODOC_CURRENT_PAGE_CONTEXT = 'injectable';
            var COMPODOC_CURRENT_PAGE_URL = 'GivenNoticePipe.html';
            var MAX_SEARCH_RESULTS = 15;
       </script>

       <script src="../js/libs/custom-elements.min.js"></script>
       <script src="../js/libs/lit-html.js"></script>
       <!-- Required to polyfill modern browsers as code is ES5 for IE... -->
       <script src="../js/libs/custom-elements-es5-adapter.js" charset="utf-8" defer></script>
       <script src="../js/menu-wc.js" defer></script>

       <script src="../js/libs/bootstrap-native.js"></script>

       <script src="../js/libs/es6-shim.min.js"></script>
       <script src="../js/libs/EventDispatcher.js"></script>
       <script src="../js/libs/promise.min.js"></script>
       <script src="../js/libs/zepto.min.js"></script>

       <script src="../js/compodoc.js"></script>

       <script src="../js/tabs.js"></script>
       <script src="../js/menu.js"></script>
       <script src="../js/libs/clipboard.min.js"></script>
       <script src="../js/libs/prism.js"></script>
       <script src="../js/sourceCode.js"></script>
          <script src="../js/search/search.js"></script>
          <script src="../js/search/lunr.min.js"></script>
          <script src="../js/search/search-lunr.js"></script>
          <script src="../js/search/search_index.js"></script>
       <script src="../js/lazy-load-graphs.js"></script>


    </body>
</html>
